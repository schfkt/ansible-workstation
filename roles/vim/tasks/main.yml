- name: install vim with support for X11
  become: true
  dnf:
    name: vim-X11
    state: present

- name: create directories for vim
  file:
    path: "{{ item }}"
    state: directory
  loop:
    - "~/.vim"
    - "~/.vim/undo"
    - "~/.vim/backup"
    - "~/.vim/swap"
    - "~/.vim/bundle"

- name: install Vundle
  git:
    repo: "https://github.com/VundleVim/Vundle.vim.git"
    dest: "~/.vim/bundle/Vundle.vim"
    update: no

- name: link the configs
  file:
    src: "~/Dropbox/df/{{ item }}"
    path: "~/{{ item }}"
    state: link
  loop:
    - .vimrc
    - .vim/ultisnips
    - .vim/nerdtree_plugin

    # NOTE: Make it work with ansible
# - name: install the plugins
#   command: 'vimx -E -s -c "source ~/.vimrc" -c PluginInstall -c qa'

- name: install packages required by YCM
  become: true
  dnf:
    name:
      - cmake
      - gcc-c++
      - make
      - python3-devel
      - golang
      - nodejs
      - npm
    state: present

- name: compile YCM
  command:
    chdir: "~/.vim/bundle/YouCompleteMe"
    cmd: "./install.py --clang-completer --go-completer --ts-completer --rust-completer"

